<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="cache-buster" content="v2.5.0-20250108160000">
    <title>FINE U - ê²Œì„</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css?v=2.5.0-20250108160000" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css?v=2.5.0-20250108160000">
    
    <!-- ì „ì—­ ë ˆë²¨ ê´€ë¦¬ ì‹œìŠ¤í…œ -->
    <script src="js/levelManager.js?v=2.5.0-20250108160000"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            zoom: 1;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        .screen {
            display: none;
            min-height: 100vh;
            position: relative;
        }
        .screen.active {
            display: block;
        }
        .card-shadow {
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #4A6FA5, #6B8DC7);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 111, 165, 0.3);
        }
        
        .level-badge-nav-v2 {
            width: 54px !important;
            height: 54px !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-weight: 800 !important;
            color: white !important;
            font-size: 9px !important;
            text-shadow: 0 2px 6px rgba(0,0,0,0.8) !important;
            position: absolute !important;
            top: -6px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            box-shadow: 
                0 8px 25px rgba(0,0,0,0.3) !important, 
                0 4px 8px rgba(0,0,0,0.2) !important, 
                inset 0 3px 0 rgba(255,255,255,0.4) !important, 
                inset 0 -3px 0 rgba(0,0,0,0.25) !important,
                0 0 0 2px rgba(255,255,255,0.1) !important;
            z-index: 10 !important;
            cursor: pointer !important;
            transition: all 0.4s cubic-bezier(0.4,0,0.2,1) !important;
            border: 2px solid rgba(255,255,255,0.3) !important;
            position: relative !important;
            overflow: hidden !important;
            letter-spacing: 0.2px !important;
            backdrop-filter: blur(6px) !important;
        }

        .level-badge-nav-v2::before {
            content: '';
            position: absolute;
            top: -30%;
            left: -30%;
            width: 160%;
            height: 160%;
            background: conic-gradient(
                from 0deg, 
                rgba(255,255,255,0) 0deg, 
                rgba(255,255,255,0.5) 30deg, 
                rgba(255,255,255,0.8) 45deg, 
                rgba(255,255,255,0.5) 60deg, 
                rgba(255,255,255,0) 90deg
            );
            animation: badgeShimmerEnhanced 5s ease-in-out infinite !important;
            pointer-events: none;
        }

        .level-badge-nav-v2:hover {
            transform: translateX(-50%) scale(1.08) rotate(3deg) !important;
            box-shadow: 
                0 12px 35px rgba(0,0,0,0.35) !important, 
                0 6px 15px rgba(0,0,0,0.25) !important, 
                inset 0 3px 0 rgba(255,255,255,0.5) !important, 
                inset 0 -3px 0 rgba(0,0,0,0.35) !important,
                0 0 0 3px rgba(255,255,255,0.15) !important,
                0 0 20px rgba(255,255,255,0.3) !important;
        }

        .level-badge-nav-v2:active {
            transform: translateX(-50%) scale(0.96) !important;
        }

        /* V4 Badge Styles - Enhanced design with improved compactness and cache busting */
        .level-badge-profile-v4 {
            display: inline-block !important;
            padding: 4px 8px !important; /* Ultra-compact design */
            border-radius: 50% !important; /* Circular design restored */
            font-size: 12px !important;
            font-weight: 700 !important;
            color: white !important;
            text-shadow: 0 1px 3px rgba(0,0,0,0.7) !important;
            position: relative !important;
            overflow: hidden !important;
            letter-spacing: 0.3px !important; /* Minimal spacing */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            box-shadow: 
                0 3px 12px rgba(0,0,0,0.2) !important, 
                inset 0 1px 0 rgba(255,255,255,0.4) !important,
                inset 0 -1px 0 rgba(0,0,0,0.25) !important;
            border: 1px solid rgba(255,255,255,0.3) !important;
            text-align: center !important;
            backdrop-filter: blur(2px) !important;
            line-height: 1.2 !important;
            white-space: nowrap !important;
        }

        .level-badge-nav-v4 {
            width: 54px !important; /* Optimized proportions */
            height: 54px !important; /* Balanced design */
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-weight: 800 !important;
            color: white !important;
            font-size: 9px !important;
            text-shadow: 0 2px 6px rgba(0,0,0,0.8) !important;
            position: absolute !important;
            top: -6px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            box-shadow: 
                0 8px 25px rgba(0,0,0,0.3) !important, 
                0 4px 8px rgba(0,0,0,0.2) !important, 
                inset 0 3px 0 rgba(255,255,255,0.4) !important, 
                inset 0 -3px 0 rgba(0,0,0,0.25) !important,
                0 0 0 2px rgba(255,255,255,0.1) !important;
            z-index: 10 !important;
            cursor: pointer !important;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
            border: 2px solid rgba(255,255,255,0.3) !important;
            position: relative !important;
            overflow: hidden !important;
            letter-spacing: 0.2px !important;
            backdrop-filter: blur(6px) !important; /* Premium effect */
        }

        .level-badge-nav-v4:hover {
            transform: translateX(-50%) scale(1.08) rotate(3deg) !important;
            box-shadow: 
                0 12px 35px rgba(0,0,0,0.35) !important, 
                0 6px 15px rgba(0,0,0,0.25) !important, 
                inset 0 3px 0 rgba(255,255,255,0.5) !important, 
                inset 0 -3px 0 rgba(0,0,0,0.35) !important,
                0 0 0 3px rgba(255,255,255,0.15) !important,
                0 0 20px rgba(255,255,255,0.3) !important;
        }

        .level-badge-nav-v4:active {
            transform: translateX(-50%) scale(0.96) !important;
        }

        @keyframes badgeShimmerEnhanced {
            0% { transform: rotate(0deg) scale(1); opacity: 0.6; }
            50% { transform: rotate(180deg) scale(1.05); opacity: 1; }
            100% { transform: rotate(360deg) scale(1); opacity: 0.6; }
        }
        
        .level-yellow { background: linear-gradient(135deg, #FCD34D, #F59E0B); }
        .level-orange { background: linear-gradient(135deg, #FB923C, #EA580C); }
        .level-green { background: linear-gradient(135deg, #34D399, #059669); }
        .level-blue { background: linear-gradient(135deg, #60A5FA, #2563EB); }
        .level-brown { background: linear-gradient(135deg, #A16207, #92400E); }
        .level-black { background: linear-gradient(135deg, #374151, #111827); }
        .level-red { background: linear-gradient(135deg, #EF4444, #DC2626); }

        .bottom-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.98) 100%);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(59, 130, 246, 0.1);
            padding: 12px 0 max(8px, env(safe-area-inset-bottom)) 0;
            z-index: 50;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.08);
        }

        .nav-container {
            max-width: 28rem;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            align-items: end;
            position: relative;
            height: 60px;
            padding: 0 8px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 8px 4px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 16px;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
            border-radius: 50%;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translate(-50%, -50%);
        }

        .nav-item:hover::before {
            width: 100%;
            height: 100%;
            border-radius: 16px;
        }

        .nav-item:hover {
            transform: translateY(-3px) scale(1.05);
        }

        .nav-item:active {
            transform: translateY(-1px) scale(0.98);
        }

        .nav-item i {
            font-size: 22px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1;
            color: #6B7280;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .nav-item span {
            font-size: 11px;
            font-weight: 600;
            position: relative;
            z-index: 1;
            color: #6B7280;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            letter-spacing: 0.3px;
        }

        .nav-item.active i {
            color: #3B82F6;
            transform: scale(1.1);
            text-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
        }

        .nav-item.active span {
            color: #3B82F6;
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(59, 130, 246, 0.2);
        }

        .nav-item.active::before {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(99, 102, 241, 0.15));
            width: 100%;
            height: 100%;
            border-radius: 16px;
        }

        .nav-center {
            grid-column: 3;
            display: flex;
            justify-content: center;
            align-items: end;
            height: 100%;
            position: relative;
        }

        .level-badge-nav {
            width: 56px; /* 64px -> 56pxë¡œ ì¡°ì • */
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: white;
            font-size: 10px; /* 11px -> 10pxë¡œ í†µì¼ */
            text-shadow: 0 2px 4px rgba(0,0,0,0.7);
            position: absolute;
            top: -8px; /* -12px -> -8pxë¡œ ì¡°ì • */
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 
                0 6px 20px rgba(0,0,0,0.25), 
                0 3px 6px rgba(0,0,0,0.15), 
                inset 0 2px 0 rgba(255,255,255,0.3), 
                inset 0 -2px 0 rgba(0,0,0,0.2);
            z-index: 10;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid rgba(255,255,255,0.25);
            position: relative;
            overflow: hidden;
            letter-spacing: 0.3px; /* 0.4px -> 0.3pxë¡œ í†µì¼ */
            backdrop-filter: blur(4px);
        }
        /* íšŒì „ ê´‘íƒ */
        .level-badge-nav::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, rgba(255,255,255,0) 0deg, rgba(255,255,255,0.35) 40deg, rgba(255,255,255,0) 80deg);
            animation: badgeShimmer 6s linear infinite;
            pointer-events: none;
        }
        /* ë°˜ì§ì´ */
        .level-badge-nav::after {
            content: '';
            position: absolute;
            inset: 0;
            background:
                radial-gradient(circle at 18% 30%, rgba(255,255,255,0.9) 0 2px, transparent 3px),
                radial-gradient(circle at 72% 24%, rgba(255,255,255,0.7) 0 2px, transparent 3px),
                radial-gradient(circle at 38% 72%, rgba(255,255,255,0.85) 0 2px, transparent 3px),
                radial-gradient(circle at 80% 66%, rgba(255,255,255,0.55) 0 2px, transparent 3px);
            mix-blend-mode: screen;
            animation: sparkleTwinkle 4s linear infinite;
            pointer-events: none;
        }
        .level-badge-nav:hover { transform: translateX(-50%) scale(1.1) rotate(5deg); }
        .level-badge-nav:active { transform: translateX(-50%) scale(0.95); }
        @keyframes badgeShimmer { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes sparkleTwinkle { 0% { opacity:.6; transform:translateY(0) scale(1); filter:blur(0);} 25% { opacity:1; transform:translateY(-1px) scale(1.05);} 50% { opacity:.4; transform:translateY(1px) scale(.95); filter:blur(.3px);} 75% { opacity:.9; transform:translateY(-1px) scale(1.08);} 100% { opacity:.6; transform:translateY(0) scale(1); filter:blur(0);} }
        
        /* Enhanced metallic level colors with depth and shine */
        .level-yellow, .level-bronze { 
            background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 25%, #D97706 50%, #92400E 75%, #F59E0B 100%);
            box-shadow: 0 8px 24px rgba(245, 158, 11, 0.3);
        }
        .level-orange, .level-silver { 
            background: linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 25%, #CBD5E1 50%, #94A3B8 75%, #E2E8F0 100%);
            box-shadow: 0 8px 24px rgba(148, 163, 184, 0.3);
        }
        .level-green, .level-gold { 
            background: linear-gradient(135deg, #FEF3C7 0%, #FCD34D 25%, #F59E0B 50%, #D97706 75%, #FCD34D 100%);
            box-shadow: 0 8px 24px rgba(245, 158, 11, 0.4);
        }
        .level-blue, .level-platinum { 
            background: linear-gradient(135deg, #F0F9FF 0%, #DBEAFE 25%, #93C5FD 50%, #3B82F6 75%, #DBEAFE 100%);
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);
        }
        .level-brown, .level-diamond { 
            background: linear-gradient(135deg, #F0FDFA 0%, #CCFBF1 25%, #5EEAD4 50%, #14B8A6 75%, #CCFBF1 100%);
            box-shadow: 0 8px 24px rgba(20, 184, 166, 0.3);
        }
        .level-black, .level-black-diamond { 
            background: linear-gradient(135deg, #4B5563 0%, #374151 25%, #1F2937 50%, #111827 75%, #374151 100%);
            box-shadow: 0 8px 24px rgba(17, 24, 39, 0.5);
        }
        .level-red, .level-ruby { 
            background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 25%, #F87171 50%, #EF4444 75%, #DC2626 100%);
            box-shadow: 0 8px 24px rgba(239, 68, 68, 0.4);
        }

        .game-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .game-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .game-canvas {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: #f8fafc;
            margin: 16px 0;
        }

        .game-button {
            background: linear-gradient(135deg, #4A6FA5, #6B8DC7);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 8px;
        }

        .game-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 111, 165, 0.3);
        }

        .ranking-badge {
            background: linear-gradient(135deg, #FCD34D, #F59E0B);
            color: #92400E;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .rocket {
            width: 40px;
            height: 60px;
            background: linear-gradient(135deg, #EF4444, #DC2626);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            position: absolute;
            transition: all 0.1s ease;
        }

        .enemy {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            position: absolute;
        }

        .bullet {
            width: 4px;
            height: 12px;
            background: #FCD34D;
            position: absolute;
            border-radius: 2px;
        }

        .owl-character {
            width: 120px;
            height: 120px;
            margin: 0 auto;
            display: block;
            border-radius: 50%;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
            position: relative;
        }

        .owl-character:hover {
            transform: scale(1.1) rotate(5deg);
            filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.2));
        }

        .owl-character:active {
            transform: scale(0.95) rotate(-2deg);
            transition: all 0.1s ease;
        }

        /* ë˜‘ë¶€ë¦¬ ê²Œì„ ì»¨í…Œì´ë„ˆ ê°œì„  */
        #owlGameContainer {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 20px;
            padding: 24px;
            margin: 16px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        /* ë°˜ì§ì´ëŠ” íš¨ê³¼ */
        .owl-character::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            border-radius: 50%;
            opacity: 0;
            animation: sparkle 3s infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: rotate(0deg); }
            50% { opacity: 1; transform: rotate(180deg); }
        }

        /* ê²Œì„ ì¹´ë“œ ê°œì„  */
        .game-card {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .game-card:hover::before {
            left: 100%;
        }

        .game-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.15);
        }

        /* ê²Œì„ ë²„íŠ¼ ê°œì„  */
        .game-button {
            background: linear-gradient(135deg, #3B82F6, #1E40AF);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
        }

        .game-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }

        .game-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .game-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.4);
        }

        .game-button:active {
            transform: translateY(0);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        /* í†µê³„ í‘œì‹œ ê°œì„  */
        .stat-item {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-item:hover {
            transform: translateY(-2px);
            background: linear-gradient(135deg, #ffffff, #f1f5f9);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #3B82F6, #1E40AF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .exp-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 12px 0;
        }

        .exp-fill {
            height: 100%;
            background: linear-gradient(135deg, #34D399, #059669);
            transition: width 0.5s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 16px;
        }

        .stat-item {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>

<!-- ê²Œì„ í™”ë©´ -->
<div id="gameScreen" class="screen active">
    <div class="min-h-screen bg-gray-100">
        <!-- ìƒë‹¨ í—¤ë” -->
        <div class="bg-white shadow-sm p-4">
            <div class="flex items-center justify-between max-w-md mx-auto">
                <button onclick="goToMainPage()" class="text-gray-600">
                    <i class="fas fa-arrow-left text-xl"></i>
                </button>
                <h1 class="text-xl font-bold">ê²Œì„</h1>
                <button onclick="refreshGames()" class="text-green-500">
                    <i class="fas fa-sync-alt text-xl"></i>
                </button>
            </div>
        </div>

        <div class="max-w-md mx-auto px-4 py-6">
            
            <!-- ê²½ì œ í€´ì¦ˆ -->
            <div class="game-card">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-brain text-3xl text-purple-500"></i>
                        <div>
                            <h3 class="text-lg font-bold">ê²½ì œ í€´ì¦ˆ</h3>
                            <p class="text-sm text-gray-500">ê²½ì œ ì§€ì‹ì„ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”</p>
                        </div>
                    </div>
                    <div class="ranking-badge">
                        <i class="fas fa-crown"></i>
                        1ë“±: ê¹€ê²½ì œ
                    </div>
                </div>
                
                <div id="quizContainer">
                    <div class="text-center py-6">
                        <i class="fas fa-play-circle text-4xl text-purple-500 mb-4"></i>
                        <p class="text-gray-600 mb-4">AIê°€ ìƒì„±í•˜ëŠ” ë‹¤ì–‘í•œ ê²½ì œ ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”!</p>
                        <button onclick="startEconomicQuiz()" class="game-button">
                            <i class="fas fa-play mr-2"></i>í€´ì¦ˆ ì‹œì‘
                        </button>
                    </div>
                </div>
            </div>

            <!-- ë¡œì¼“ë¹µì•¼ -->
            <div class="game-card">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-rocket text-3xl text-red-500"></i>
                        <div>
                            <h3 class="text-lg font-bold">ë¡œì¼“ë¹µì•¼</h3>
                            <p class="text-sm text-gray-500">í„°ì¹˜ë¡œ ìš°ì£¼ì„ ì„ ì¡°ì‘í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                    <div class="ranking-badge">
                        <i class="fas fa-crown"></i>
                        1ë“±: ë°•íˆ¬ì
                    </div>
                </div>
                
                <div id="rocketGameContainer">
                    <canvas id="rocketCanvas" class="game-canvas" width="320" height="400"></canvas>
                    <div class="text-center">
                        <p class="text-sm text-gray-600 mb-2">ì ìˆ˜: <span id="rocketScore">0</span></p>
                        <button onclick="startRocketGame()" id="rocketStartBtn" class="game-button">
                            <i class="fas fa-play mr-2"></i>ê²Œì„ ì‹œì‘
                        </button>
                        <button onclick="pauseRocketGame()" id="rocketPauseBtn" class="game-button" style="display: none;">
                            <i class="fas fa-pause mr-2"></i>ì¼ì‹œì •ì§€
                        </button>
                    </div>
                    <div class="text-xs text-gray-500 text-center mt-2">
                        í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ë¡œì¼“ì„ ì¢Œìš°ë¡œ ì›€ì§ì´ì„¸ìš”
                    </div>
                </div>
            </div>

            <!-- ë˜‘ë¶€ë¦¬ í‚¤ìš°ê¸° -->
            <div class="game-card mb-24">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-seedling text-3xl text-green-500"></i>
                        <div>
                            <h3 class="text-lg font-bold">ë˜‘ë¶€ë¦¬ í‚¤ìš°ê¸°</h3>
                            <p class="text-sm text-gray-500">ê²½ì œ ì§€ì‹ìœ¼ë¡œ ë˜‘ë¶€ë¦¬ë¥¼ í‚¤ì›Œë³´ì„¸ìš”</p>
                        </div>
                    </div>
                    <div class="ranking-badge">
                        <i class="fas fa-crown"></i>
                        1ë“±: ì´ê¸ˆìœµ
                    </div>
                </div>
                
                <div id="owlGameContainer" class="text-center">
                    <img src="IMG_4014.png" 
                         alt="ë˜‘ë¶€ë¦¬" class="owl-character" onclick="petOwl()">
                    
                    <div class="mt-4">
                        <h4 class="font-bold text-lg" id="owlName">ë˜‘ë¶€ë¦¬</h4>
                        <p class="text-sm text-gray-600" id="owlLevel">ë ˆë²¨ 1 - ì´ˆë³´ íˆ¬ìì</p>
                    </div>
                    
                    <div class="exp-bar">
                        <div class="exp-fill" id="owlExpBar" style="width: 30%;"></div>
                    </div>
                    <p class="text-xs text-gray-500" id="owlExp">ê²½í—˜ì¹˜: 300 / 1000</p>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="owlKnowledge">85</div>
                            <div class="text-xs text-gray-600">ê²½ì œ ì§€ì‹</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="owlInvestment">42</div>
                            <div class="text-xs text-gray-600">íˆ¬ì ì‹¤ë ¥</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="owlHappiness">78</div>
                            <div class="text-xs text-gray-600">í–‰ë³µë„</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="owlMoney">1,250</div>
                            <div class="text-xs text-gray-600">ë³´ìœ  ì½”ì¸</div>
                        </div>
                    </div>
                    
                    <div class="mt-4 space-x-2">
                        <button onclick="feedOwl()" class="game-button">
                            <i class="fas fa-hamburger mr-2"></i>ë¨¹ì´ì£¼ê¸°
                        </button>
                        <button onclick="studyWithOwl()" class="game-button">
                            <i class="fas fa-book mr-2"></i>ê³µë¶€í•˜ê¸°
                        </button>
                        <button onclick="investWithOwl()" class="game-button">
                            <i class="fas fa-chart-line mr-2"></i>íˆ¬ìí•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="bottom-navigation">
            <div class="nav-container">
                <button onclick="goToMainPage()" class="nav-item">
                    <i class="fas fa-home text-gray-400"></i>
                    <span class="text-gray-400">í™ˆ</span>
                </button>
                <button onclick="goToNewsPage()" class="nav-item">
                    <i class="fas fa-newspaper text-gray-400"></i>
                    <span class="text-gray-400">ë‰´ìŠ¤</span>
                </button>
                <div class="nav-center">
                    <div id="navLevelBadge" class="level-badge-nav-v4" onclick="goToGradePage()" style="width: 54px !important; height: 54px !important;">
                        BRONZE
                    </div>
                </div>
                <button onclick="goToGamePage()" class="nav-item active">
                    <i class="fas fa-gamepad"></i>
                    <span>ê²Œì„</span>
                </button>
                <button onclick="goToMorePage()" class="nav-item">
                    <i class="fas fa-ellipsis-h text-gray-400"></i>
                    <span class="text-gray-400">ë”ë³´ê¸°</span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// ì „ì—­ ê²Œì„ ë³€ìˆ˜ë“¤
var currentUser = null;
var quizQuestions = [];
var currentQuizIndex = 0;
var quizScore = 0;

// ë¡œì¼“ ê²Œì„ ë³€ìˆ˜ë“¤ (í–¥ìƒëœ ë²„ì „)
var rocketGame = {
    canvas: null,
    ctx: null,
    rocket: { 
        x: 160, 
        y: 350, 
        width: 40, 
        height: 60,
        targetX: 160,
        rotation: 0,
        thruster: 0
    },
    enemies: [],
    bullets: [],
    particles: [],
    explosions: [],
    powerUps: [],
    score: 0,
    gameLoop: null,
    isRunning: false,
    keys: {},
    sounds: {
        shoot: null,
        explosion: null,
        powerUp: null,
        background: null
    },
    background: {
        stars: [],
        speed: 1
    }
};

// ë˜‘ë¶€ë¦¬ ê²Œì„ ë³€ìˆ˜ë“¤
var owlData = JSON.parse(localStorage.getItem('owlData')) || {
    name: 'ë˜‘ë¶€ë¦¬',
    level: 1,
    exp: 300,
    maxExp: 1000,
    knowledge: 85,
    investment: 42,
    happiness: 78,
    money: 1250
};

// í˜ì´ì§€ ì´ë™ í•¨ìˆ˜ë“¤
function goToMainPage() {
    window.location.href = 'index.html?v=' + Date.now();
}

function goToNewsPage() {
    window.location.href = 'a2.html?v=' + Date.now();
}

function goToGradePage() {
    window.location.href = 'a5.html?v=' + Date.now();
}

function goToGamePage() {
    window.location.href = 'a4.html?v=' + Date.now();
}

function goToMorePage() {
    window.location.href = 'a3.html?v=' + Date.now();
}

// ê²½ì œ í€´ì¦ˆ ì‹œì‘
function startEconomicQuiz() {
    generateQuizQuestions();
    currentQuizIndex = 0;
    quizScore = 0;
    showQuizQuestion();
}

// í€´ì¦ˆ ë¬¸ì œ ìƒì„±
function generateQuizQuestions() {
    quizQuestions = [
        {
            question: "GDPëŠ” ë¬´ì—‡ì˜ ì¤„ì„ë§ì¸ê°€ìš”?",
            options: ["Gross Domestic Product", "Global Development Program", "General Data Processing", "Great Digital Platform"],
            correct: 0,
            explanation: "GDPëŠ” Gross Domestic Product(êµ­ë‚´ì´ìƒì‚°)ì˜ ì¤„ì„ë§ë¡œ, í•œ ë‚˜ë¼ì˜ ê²½ì œ ê·œëª¨ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œì…ë‹ˆë‹¤."
        },
        {
            question: "ì¤‘ì•™ì€í–‰ì˜ ê¸°ì¤€ê¸ˆë¦¬ ì¸ìƒ íš¨ê³¼ëŠ”?",
            options: ["ê²½ê¸° ë¶€ì–‘", "ì¸í”Œë ˆì´ì…˜ ì–µì œ", "ìˆ˜ì¶œ ì¦ê°€", "ì‹¤ì—…ë¥  ê°ì†Œ"],
            correct: 1,
            explanation: "ê¸°ì¤€ê¸ˆë¦¬ ì¸ìƒì€ ì‹œì¤‘ì˜ ëˆì˜ ì–‘ì„ ì¤„ì—¬ ì¸í”Œë ˆì´ì…˜ì„ ì–µì œí•˜ëŠ” íš¨ê³¼ê°€ ìˆìŠµë‹ˆë‹¤."
        },
        {
            question: "ì£¼ì‹ì˜ PERì´ ë†’ë‹¤ëŠ” ê²ƒì€?",
            options: ["ì €í‰ê°€", "ê³ í‰ê°€", "ì ì •ê°€ì¹˜", "ìœ„í—˜ ë‚®ìŒ"],
            correct: 1,
            explanation: "PERì´ ë†’ë‹¤ëŠ” ê²ƒì€ ì£¼ê°€ê°€ ìˆ˜ìµì— ë¹„í•´ ë†’ê²Œ í‰ê°€ë˜ê³  ìˆë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤."
        },
        {
            question: "ë¶„ì‚°íˆ¬ìì˜ ëª©ì ì€?",
            options: ["ìˆ˜ìµ ê·¹ëŒ€í™”", "ìœ„í—˜ ê°ì†Œ", "ê±°ë˜ë¹„ìš© ì ˆì•½", "ì„¸ê¸ˆ ì ˆì•½"],
            correct: 1,
            explanation: "ë¶„ì‚°íˆ¬ìëŠ” ì—¬ëŸ¬ ìì‚°ì— íˆ¬ìí•˜ì—¬ ìœ„í—˜ì„ ë¶„ì‚°ì‹œí‚¤ëŠ” ê²ƒì´ ì£¼ëª©ì ì…ë‹ˆë‹¤."
        },
        {
            question: "ì¸í”Œë ˆì´ì…˜ì˜ ì›ì¸ì´ ì•„ë‹Œ ê²ƒì€?",
            options: ["í†µí™”ëŸ‰ ì¦ê°€", "ìˆ˜ìš” ì¦ê°€", "ê³µê¸‰ ê°ì†Œ", "ì €ì¶• ì¦ê°€"],
            correct: 3,
            explanation: "ì €ì¶• ì¦ê°€ëŠ” ì†Œë¹„ ê°ì†Œë¥¼ ì˜ë¯¸í•˜ë¯€ë¡œ ì¸í”Œë ˆì´ì…˜ê³¼ëŠ” ë°˜ëŒ€ íš¨ê³¼ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤."
        }
    ];
    
    // ë¬¸ì œ ìˆœì„œ ëœë¤í™”
    quizQuestions.sort(() => Math.random() - 0.5);
}

// í€´ì¦ˆ ë¬¸ì œ í‘œì‹œ
function showQuizQuestion() {
    if (currentQuizIndex >= quizQuestions.length) {
        showQuizResult();
        return;
    }
    
    var question = quizQuestions[currentQuizIndex];
    var html = '<div class="mb-6">';
    html += '<h4 class="text-lg font-bold mb-4">ë¬¸ì œ ' + (currentQuizIndex + 1) + '/' + quizQuestions.length + '</h4>';
    html += '<p class="text-gray-700 mb-4">' + question.question + '</p>';
    
    question.options.forEach(function(option, index) {
        html += '<div class="bg-gray-50 p-3 rounded-lg mb-2 cursor-pointer hover:bg-blue-50 transition-colors" onclick="selectAnswer(' + index + ')">';
        html += '<span>' + (index + 1) + '. ' + option + '</span>';
        html += '</div>';
    });
    
    html += '</div>';
    document.getElementById('quizContainer').innerHTML = html;
}

// í€´ì¦ˆ ë‹µ ì„ íƒ
function selectAnswer(selectedIndex) {
    var question = quizQuestions[currentQuizIndex];
    var isCorrect = selectedIndex === question.correct;
    
    if (isCorrect) {
        quizScore++;
        gainOwlExp(50);
    }
    
    // ì •ë‹µ í‘œì‹œ
    var options = document.querySelectorAll('#quizContainer .bg-gray-50');
    options.forEach(function(option, index) {
        option.onclick = null;
        if (index === question.correct) {
            option.classList.add('bg-green-100', 'border-green-500');
            option.classList.remove('bg-gray-50');
        } else if (index === selectedIndex && !isCorrect) {
            option.classList.add('bg-red-100', 'border-red-500');
            option.classList.remove('bg-gray-50');
        }
    });
    
    // ì„¤ëª… í‘œì‹œ
    setTimeout(function() {
        var explanation = document.createElement('div');
        explanation.className = 'mt-4 p-4 bg-blue-50 rounded-lg';
        explanation.innerHTML = '<p class="text-sm text-blue-800"><strong>í•´ì„¤:</strong> ' + question.explanation + '</p>';
        document.getElementById('quizContainer').appendChild(explanation);
        
        var nextBtn = document.createElement('button');
        nextBtn.className = 'game-button mt-4';
        nextBtn.textContent = currentQuizIndex < quizQuestions.length - 1 ? 'ë‹¤ìŒ ë¬¸ì œ' : 'ê²°ê³¼ ë³´ê¸°';
        nextBtn.onclick = function() {
            currentQuizIndex++;
            showQuizQuestion();
        };
        document.getElementById('quizContainer').appendChild(nextBtn);
    }, 1500);
}

// í€´ì¦ˆ ê²°ê³¼ í‘œì‹œ
function showQuizResult() {
    var percentage = Math.round((quizScore / quizQuestions.length) * 100);
    var expGained = quizScore * 100;
    
    var html = '<div class="text-center py-6">';
    html += '<i class="fas fa-trophy text-6xl text-yellow-500 mb-4"></i>';
    html += '<h3 class="text-2xl font-bold mb-4">í€´ì¦ˆ ì™„ë£Œ!</h3>';
    html += '<p class="text-lg mb-2">ì ìˆ˜: ' + quizScore + '/' + quizQuestions.length + ' (' + percentage + '%)</p>';
    html += '<p class="text-green-600 font-semibold mb-4">íšë“ EXP: +' + expGained + '</p>';
    
    if (percentage >= 80) {
        html += '<p class="text-blue-600 mb-4">ğŸ‰ í›Œë¥­í•©ë‹ˆë‹¤!</p>';
    } else if (percentage >= 60) {
        html += '<p class="text-green-600 mb-4">ğŸ‘ ì¢‹ì€ ì„±ê³¼ì…ë‹ˆë‹¤!</p>';
    } else {
        html += '<p class="text-orange-600 mb-4">ğŸ’ª ë” ì—´ì‹¬íˆ ê³µë¶€í•´ë³´ì„¸ìš”!</p>';
    }
    
    html += '<button onclick="startEconomicQuiz()" class="game-button mr-2">ë‹¤ì‹œ ë„ì „</button>';
    html += '<button onclick="location.reload()" class="game-button">ë©”ì¸ìœ¼ë¡œ</button>';
    html += '</div>';
    
    document.getElementById('quizContainer').innerHTML = html;
    gainOwlExp(expGained);
}

// ë¡œì¼“ ê²Œì„ ì‹œì‘ (í–¥ìƒëœ ë²„ì „)
function startRocketGame() {
    try {
        console.log('Starting rocket game...');
        rocketGame.canvas = document.getElementById('rocketCanvas');
        
        if (!rocketGame.canvas) {
            console.error('Canvas element not found!');
            alert('ê²Œì„ ìº”ë²„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        rocketGame.ctx = rocketGame.canvas.getContext('2d');
        
        if (!rocketGame.ctx) {
            console.error('Cannot get 2D context!');
            alert('ìº”ë²„ìŠ¤ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        // ì˜¤ë””ì˜¤ ì´ˆê¸°í™”
        initializeGameAudio();
        
        // ë°°ê²½ ë³„ë“¤ ì´ˆê¸°í™”
        initializeStarField();
        
        // í„°ì¹˜ ì´ë²¤íŠ¸ ì¶”ê°€
        rocketGame.canvas.addEventListener('touchstart', handleTouch, { passive: false });
        rocketGame.canvas.addEventListener('touchmove', handleTouch, { passive: false });
        
        // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
        rocketGame.canvas.addEventListener('click', handleClick);
        
        resetRocketGame();
        rocketGame.isRunning = true;
        document.getElementById('rocketStartBtn').style.display = 'none';
        document.getElementById('rocketPauseBtn').style.display = 'inline-block';
        
        // ë°°ê²½ìŒì•… ì¬ìƒ
        if (rocketGame.sounds.background) {
            rocketGame.sounds.background.play().catch(e => console.log('ì˜¤ë””ì˜¤ ì¬ìƒ ì‹¤íŒ¨:', e));
        }
        
        rocketGame.gameLoop = setInterval(updateRocketGame, 16); // 60 FPS
        console.log('Rocket game started successfully!');
        
    } catch (error) {
        console.error('ë¡œì¼“ ê²Œì„ ì‹œì‘ ì˜¤ë¥˜:', error);
        alert('ê²Œì„ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + error.message);
    }
}

// ê²Œì„ ì˜¤ë””ì˜¤ ì´ˆê¸°í™”
function initializeGameAudio() {
    try {
        // Web Audio API ì‚¬ìš©í•˜ì—¬ ì‚¬ìš´ë“œ ìƒì„±
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // ìŠˆíŒ… ì‚¬ìš´ë“œ
        rocketGame.sounds.shoot = createShootSound(audioContext);
        
        // í­ë°œ ì‚¬ìš´ë“œ  
        rocketGame.sounds.explosion = createExplosionSound(audioContext);
        
        // íŒŒì›Œì—… ì‚¬ìš´ë“œ
        rocketGame.sounds.powerUp = createPowerUpSound(audioContext);
        
    } catch (error) {
        console.log('ì˜¤ë””ì˜¤ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
    }
}

// ìŠˆíŒ… ì‚¬ìš´ë“œ ìƒì„±
function createShootSound(audioContext) {
    return function() {
        try {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        } catch (e) {}
    };
}

// í­ë°œ ì‚¬ìš´ë“œ ìƒì„±
function createExplosionSound(audioContext) {
    return function() {
        try {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filterNode = audioContext.createBiquadFilter();
            
            oscillator.connect(filterNode);
            filterNode.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(30, audioContext.currentTime + 0.3);
            
            filterNode.frequency.setValueAtTime(1000, audioContext.currentTime);
            filterNode.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.3);
            
            gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        } catch (e) {}
    };
}

// íŒŒì›Œì—… ì‚¬ìš´ë“œ ìƒì„±
function createPowerUpSound(audioContext) {
    return function() {
        try {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.2);
            
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        } catch (e) {}
    };
}

// ë°°ê²½ ë³„ë“¤ ì´ˆê¸°í™”
function initializeStarField() {
    rocketGame.background.stars = [];
    for (let i = 0; i < 50; i++) {
        rocketGame.background.stars.push({
            x: Math.random() * rocketGame.canvas.width,
            y: Math.random() * rocketGame.canvas.height,
            size: Math.random() * 2 + 1,
            speed: Math.random() * 2 + 1,
            brightness: Math.random() * 0.5 + 0.5
        });
    }
}

// í„°ì¹˜ ì´ë²¤íŠ¸ ì²˜ë¦¬ (í–¥ìƒëœ ë²„ì „)
function handleTouch(e) {
    e.preventDefault();
    var rect = rocketGame.canvas.getBoundingClientRect();
    var touch = e.touches[0] || e.changedTouches[0];
    var x = touch.clientX - rect.left;
    
    // ë¶€ë“œëŸ¬ìš´ ì´ë™ì„ ìœ„í•´ ëª©í‘œ ìœ„ì¹˜ë§Œ ì„¤ì •
    rocketGame.rocket.targetX = Math.max(rocketGame.rocket.width/2, Math.min(x, rocketGame.canvas.width - rocketGame.rocket.width/2));
    
    // ì¶”ì§„ê¸° íš¨ê³¼ í™œì„±í™”
    rocketGame.rocket.thruster = 10;
}

// í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬ (í–¥ìƒëœ ë²„ì „)
function handleClick(e) {
    var rect = rocketGame.canvas.getBoundingClientRect();
    var x = e.clientX - rect.left;
    
    // ë¶€ë“œëŸ¬ìš´ ì´ë™ì„ ìœ„í•´ ëª©í‘œ ìœ„ì¹˜ë§Œ ì„¤ì •
    rocketGame.rocket.targetX = Math.max(rocketGame.rocket.width/2, Math.min(x, rocketGame.canvas.width - rocketGame.rocket.width/2));
    
    // ì¶”ì§„ê¸° íš¨ê³¼ í™œì„±í™”
    rocketGame.rocket.thruster = 10;
    
    // ì´ì•Œ ë°œì‚¬
    shootBullet();
}

// ì´ì•Œ ë°œì‚¬ í•¨ìˆ˜
function shootBullet() {
    rocketGame.bullets.push({
        x: rocketGame.rocket.x + rocketGame.rocket.width / 2 - 2,
        y: rocketGame.rocket.y,
        speed: 8,
        trail: []
    });
    
    // ìŠˆíŒ… ì‚¬ìš´ë“œ ì¬ìƒ
    if (rocketGame.sounds.shoot) {
        rocketGame.sounds.shoot();
    }
}

// ë¡œì¼“ ê²Œì„ ì´ˆê¸°í™” (í–¥ìƒëœ ë²„ì „)
function resetRocketGame() {
    rocketGame.rocket.x = 160;
    rocketGame.rocket.y = 350;
    rocketGame.rocket.targetX = 160;
    rocketGame.rocket.rotation = 0;
    rocketGame.rocket.thruster = 0;
    rocketGame.enemies = [];
    rocketGame.bullets = [];
    rocketGame.particles = [];
    rocketGame.explosions = [];
    rocketGame.powerUps = [];
    rocketGame.score = 0;
    updateRocketScore();
}

// ë¡œì¼“ ê²Œì„ ì—…ë°ì´íŠ¸ (ì™„ì „íˆ í–¥ìƒëœ ë²„ì „)
function updateRocketGame() {
    if (!rocketGame.isRunning) return;
    
    var ctx = rocketGame.ctx;
    var canvas = rocketGame.canvas;
    
    // ë°°ê²½ ê·¸ë¼ë°ì´ì…˜
    var gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
    gradient.addColorStop(0, '#0f0f23');
    gradient.addColorStop(0.5, '#1a1a40');
    gradient.addColorStop(1, '#2d1b69');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // ë³„ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
    updateStarField(ctx, canvas);
    
    // ë¡œì¼“ ë¶€ë“œëŸ¬ìš´ ì´ë™
    updateRocketMovement();
    
    // ì  ìƒì„± (ë” ë‹¤ì–‘í•˜ê³  ìŠ¤ë§ˆíŠ¸í•˜ê²Œ)
    spawnEnemies();
    
    // íŒŒì›Œì—… ìƒì„±
    spawnPowerUps();
    
    // ìë™ ì´ì•Œ ë°œì‚¬ (ë” ë¶€ë“œëŸ½ê²Œ)
    if (Math.random() < 0.15) {
        shootBullet();
    }
    
    // ì¶”ì§„ê¸° íŒŒí‹°í´ ìƒì„±
    createThrusterParticles();
    
    // ë¡œì¼“ ê·¸ë¦¬ê¸° (ë” ë©‹ì§€ê²Œ)
    drawEnhancedRocket(ctx);
    
    // ì ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
    updateAndDrawEnemies(ctx, canvas);
    
    // ì´ì•Œë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
    updateAndDrawBullets(ctx, canvas);
    
    // íŒŒí‹°í´ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
    updateAndDrawParticles(ctx);
    
    // í­ë°œë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
    updateAndDrawExplosions(ctx);
    
    // íŒŒì›Œì—…ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
    updateAndDrawPowerUps(ctx, canvas);
    
    // ì¶”ì§„ê¸° íš¨ê³¼ ê°ì†Œ
    if (rocketGame.rocket.thruster > 0) {
        rocketGame.rocket.thruster--;
    }
}

// ë³„ë“¤ ì—…ë°ì´íŠ¸
function updateStarField(ctx, canvas) {
    rocketGame.background.stars.forEach(star => {
        star.y += star.speed;
        if (star.y > canvas.height) {
            star.y = -5;
            star.x = Math.random() * canvas.width;
        }
        
        // ë³„ ê·¸ë¦¬ê¸°
        ctx.fillStyle = `rgba(255, 255, 255, ${star.brightness})`;
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.size, 0, 2 * Math.PI);
        ctx.fill();
    });
}

// ë¡œì¼“ ë¶€ë“œëŸ¬ìš´ ì´ë™
function updateRocketMovement() {
    const dx = rocketGame.rocket.targetX - rocketGame.rocket.x;
    rocketGame.rocket.x += dx * 0.15; // ë¶€ë“œëŸ¬ìš´ ì´ë™
    
    // ë¡œì¼“ ê¸°ìš¸ê¸° ê³„ì‚°
    rocketGame.rocket.rotation = dx * 0.002;
}

// ì  ìƒì„± (í–¥ìƒëœ ë²„ì „)
function spawnEnemies() {
    if (Math.random() < 0.03) {
        const enemyTypes = [
            { type: 'basic', color: '#EF4444', size: 15, speed: 2, points: 100 },
            { type: 'fast', color: '#F59E0B', size: 12, speed: 4, points: 150 },
            { type: 'big', color: '#8B5CF6', size: 20, speed: 1, points: 200 },
            { type: 'good', color: '#10B981', size: 15, speed: 2, points: -50 } // ì¢‹ì€ ì 
        ];
        
        const enemyType = enemyTypes[Math.floor(Math.random() * enemyTypes.length)];
        
        rocketGame.enemies.push({
            x: Math.random() * (rocketGame.canvas.width - enemyType.size * 2),
            y: -enemyType.size,
            ...enemyType,
            rotation: 0,
            pulse: 0
        });
    }
}

// íŒŒì›Œì—… ìƒì„±
function spawnPowerUps() {
    if (Math.random() < 0.005) { // 0.5% í™•ë¥ 
        rocketGame.powerUps.push({
            x: Math.random() * (rocketGame.canvas.width - 20),
            y: -20,
            type: 'score',
            rotation: 0,
            pulse: 0
        });
    }
}

// ì¶”ì§„ê¸° íŒŒí‹°í´ ìƒì„±
function createThrusterParticles() {
    if (rocketGame.rocket.thruster > 0) {
        for (let i = 0; i < 3; i++) {
            rocketGame.particles.push({
                x: rocketGame.rocket.x + rocketGame.rocket.width/2 + (Math.random() - 0.5) * 10,
                y: rocketGame.rocket.y + rocketGame.rocket.height,
                vx: (Math.random() - 0.5) * 2,
                vy: Math.random() * 3 + 2,
                life: 30,
                maxLife: 30,
                type: 'thruster'
            });
        }
    }
}

// í–¥ìƒëœ ë¡œì¼“ ê·¸ë¦¬ê¸°
function drawEnhancedRocket(ctx) {
    const rocket = rocketGame.rocket;
    
    ctx.save();
    ctx.translate(rocket.x + rocket.width/2, rocket.y + rocket.height/2);
    ctx.rotate(rocket.rotation);
    
    // ë¡œì¼“ ë³¸ì²´ ê·¸ë¼ë°ì´ì…˜
    const gradient = ctx.createLinearGradient(0, -rocket.height/2, 0, rocket.height/2);
    gradient.addColorStop(0, '#FF6B6B');
    gradient.addColorStop(0.5, '#EE5A52');
    gradient.addColorStop(1, '#DC2626');
    
    // ë¡œì¼“ ë³¸ì²´
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.moveTo(0, -rocket.height/2);
    ctx.lineTo(-rocket.width/2, rocket.height/2);
    ctx.lineTo(rocket.width/2, rocket.height/2);
    ctx.closePath();
    ctx.fill();
    
    // ë¡œì¼“ í•˜ì´ë¼ì´íŠ¸
    ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
    ctx.beginPath();
    ctx.moveTo(0, -rocket.height/2);
    ctx.lineTo(-rocket.width/4, rocket.height/4);
    ctx.lineTo(0, rocket.height/4);
    ctx.closePath();
    ctx.fill();
    
    // ì¶”ì§„ê¸° íš¨ê³¼
    if (rocket.thruster > 0) {
        const thrusterGradient = ctx.createLinearGradient(0, rocket.height/2, 0, rocket.height/2 + 20);
        thrusterGradient.addColorStop(0, '#FCD34D');
        thrusterGradient.addColorStop(1, 'rgba(252, 211, 77, 0)');
        
        ctx.fillStyle = thrusterGradient;
        ctx.beginPath();
        ctx.moveTo(-rocket.width/4, rocket.height/2);
        ctx.lineTo(rocket.width/4, rocket.height/2);
        ctx.lineTo(0, rocket.height/2 + rocket.thruster * 2);
        ctx.closePath();
        ctx.fill();
    }
    
    ctx.restore();
}

// ì ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸° (í–¥ìƒëœ ë²„ì „)
function updateAndDrawEnemies(ctx, canvas) {
    rocketGame.enemies = rocketGame.enemies.filter(function(enemy) {
        enemy.y += enemy.speed;
        enemy.rotation += 0.1;
        enemy.pulse += 0.2;
        
        // ì  ê·¸ë¦¬ê¸° (ë” ë©‹ì§€ê²Œ)
        ctx.save();
        ctx.translate(enemy.x + enemy.size, enemy.y + enemy.size);
        ctx.rotate(enemy.rotation);
        
        // ë§¥ë™ íš¨ê³¼
        const scale = 1 + Math.sin(enemy.pulse) * 0.1;
        ctx.scale(scale, scale);
        
        // ì  ê·¸ë¼ë°ì´ì…˜
        const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, enemy.size);
        gradient.addColorStop(0, enemy.color);
        gradient.addColorStop(1, enemy.color + '80');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(0, 0, enemy.size, 0, 2 * Math.PI);
        ctx.fill();
        
        // ì  í•˜ì´ë¼ì´íŠ¸
        ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.beginPath();
        ctx.arc(-enemy.size/3, -enemy.size/3, enemy.size/3, 0, 2 * Math.PI);
        ctx.fill();
        
        ctx.restore();
        
        // ì ì´ í™”ë©´ í•˜ë‹¨ì— ë„ë‹¬í•˜ë©´ ì œê±°
        if (enemy.y > canvas.height + enemy.size) {
            return false;
        }
        
        // ë¡œì¼“ê³¼ ì¶©ëŒ ì²´í¬
        const rocketCenterX = rocketGame.rocket.x + rocketGame.rocket.width/2;
        const rocketCenterY = rocketGame.rocket.y + rocketGame.rocket.height/2;
        const enemyCenterX = enemy.x + enemy.size;
        const enemyCenterY = enemy.y + enemy.size;
        const distance = Math.sqrt(Math.pow(rocketCenterX - enemyCenterX, 2) + Math.pow(rocketCenterY - enemyCenterY, 2));
        
        if (distance < enemy.size + 20) {
            if (enemy.type === 'good') {
                rocketGame.score += enemy.points;
                createExplosion(enemy.x + enemy.size, enemy.y + enemy.size, '#10B981');
                if (rocketGame.sounds.powerUp) rocketGame.sounds.powerUp();
            } else {
                createExplosion(enemy.x + enemy.size, enemy.y + enemy.size, enemy.color);
                if (rocketGame.sounds.explosion) rocketGame.sounds.explosion();
                gameOver();
            }
            updateRocketScore();
            return false;
        }
        
        return true;
    });
}

// ì´ì•Œë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸° (í–¥ìƒëœ ë²„ì „)
function updateAndDrawBullets(ctx, canvas) {
    rocketGame.bullets = rocketGame.bullets.filter(function(bullet) {
        bullet.y -= bullet.speed;
        
        // ì´ì•Œ ê¶¤ì  ì—…ë°ì´íŠ¸
        bullet.trail.push({ x: bullet.x + 2, y: bullet.y + 6 });
        if (bullet.trail.length > 5) {
            bullet.trail.shift();
        }
        
        // ì´ì•Œ ê¶¤ì  ê·¸ë¦¬ê¸°
        if (bullet.trail.length > 1) {
            ctx.strokeStyle = 'rgba(252, 211, 77, 0.6)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(bullet.trail[0].x, bullet.trail[0].y);
            for (let i = 1; i < bullet.trail.length; i++) {
                ctx.lineTo(bullet.trail[i].x, bullet.trail[i].y);
            }
            ctx.stroke();
        }
        
        // ì´ì•Œ ê·¸ë¦¬ê¸° (ê¸€ë¡œìš° íš¨ê³¼)
        const gradient = ctx.createRadialGradient(bullet.x + 2, bullet.y + 6, 0, bullet.x + 2, bullet.y + 6, 6);
        gradient.addColorStop(0, '#FCD34D');
        gradient.addColorStop(1, 'rgba(252, 211, 77, 0)');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(bullet.x + 2, bullet.y + 6, 6, 0, 2 * Math.PI);
        ctx.fill();
        
        ctx.fillStyle = '#FCD34D';
        ctx.fillRect(bullet.x, bullet.y, 4, 12);
        
        // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ì œê±°
        if (bullet.y < -20) return false;
        
        // ì ê³¼ ì¶©ëŒ ì²´í¬
        var hit = false;
        rocketGame.enemies = rocketGame.enemies.filter(function(enemy) {
            const distance = Math.sqrt(Math.pow(bullet.x + 2 - (enemy.x + enemy.size), 2) + Math.pow(bullet.y + 6 - (enemy.y + enemy.size), 2));
            
            if (distance < enemy.size + 5) {
                rocketGame.score += enemy.points;
                updateRocketScore();
                
                // í­ë°œ ìƒì„±
                createExplosion(enemy.x + enemy.size, enemy.y + enemy.size, enemy.color);
                
                if (rocketGame.sounds.explosion) rocketGame.sounds.explosion();
                hit = true;
                return false;
            }
            return true;
        });
        
        return !hit;
    });
}

// íŒŒí‹°í´ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
function updateAndDrawParticles(ctx) {
    rocketGame.particles = rocketGame.particles.filter(function(particle) {
        particle.x += particle.vx;
        particle.y += particle.vy;
        particle.life--;
        
        const alpha = particle.life / particle.maxLife;
        
        if (particle.type === 'thruster') {
            ctx.fillStyle = `rgba(252, 211, 77, ${alpha * 0.8})`;
        } else {
            ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
        }
        
        ctx.beginPath();
        ctx.arc(particle.x, particle.y, 2, 0, 2 * Math.PI);
        ctx.fill();
        
        return particle.life > 0;
    });
}

// í­ë°œ ìƒì„±
function createExplosion(x, y, color) {
    for (let i = 0; i < 15; i++) {
        const angle = (Math.PI * 2 / 15) * i;
        const speed = Math.random() * 5 + 2;
        
        rocketGame.particles.push({
            x: x,
            y: y,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            life: 30,
            maxLife: 30,
            type: 'explosion',
            color: color
        });
    }
}

// í­ë°œë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
function updateAndDrawExplosions(ctx) {
    rocketGame.explosions = rocketGame.explosions.filter(function(explosion) {
        explosion.life--;
        explosion.radius += 2;
        
        const alpha = explosion.life / explosion.maxLife;
        
        ctx.strokeStyle = `rgba(255, 255, 255, ${alpha})`;
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(explosion.x, explosion.y, explosion.radius, 0, 2 * Math.PI);
        ctx.stroke();
        
        return explosion.life > 0;
    });
}

// íŒŒì›Œì—…ë“¤ ì—…ë°ì´íŠ¸ ë° ê·¸ë¦¬ê¸°
function updateAndDrawPowerUps(ctx, canvas) {
    rocketGame.powerUps = rocketGame.powerUps.filter(function(powerUp) {
        powerUp.y += 1.5;
        powerUp.rotation += 0.1;
        powerUp.pulse += 0.15;
        
        // íŒŒì›Œì—… ê·¸ë¦¬ê¸°
        ctx.save();
        ctx.translate(powerUp.x + 10, powerUp.y + 10);
        ctx.rotate(powerUp.rotation);
        
        const scale = 1 + Math.sin(powerUp.pulse) * 0.2;
        ctx.scale(scale, scale);
        
        // ê¸€ë¡œìš° íš¨ê³¼
        const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, 15);
        gradient.addColorStop(0, '#60A5FA');
        gradient.addColorStop(1, 'rgba(96, 165, 250, 0)');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(0, 0, 15, 0, 2 * Math.PI);
        ctx.fill();
        
        // íŒŒì›Œì—… ì•„ì´ì½˜
        ctx.fillStyle = '#60A5FA';
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('â˜…', 0, 5);
        
        ctx.restore();
        
        // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ì œê±°
        if (powerUp.y > canvas.height) {
            return false;
        }
        
        // ë¡œì¼“ê³¼ ì¶©ëŒ ì²´í¬
        const distance = Math.sqrt(Math.pow(rocketGame.rocket.x + rocketGame.rocket.width/2 - (powerUp.x + 10), 2) + Math.pow(rocketGame.rocket.y + rocketGame.rocket.height/2 - (powerUp.y + 10), 2));
        
        if (distance < 25) {
            rocketGame.score += 500;
            updateRocketScore();
            createExplosion(powerUp.x + 10, powerUp.y + 10, '#60A5FA');
            if (rocketGame.sounds.powerUp) rocketGame.sounds.powerUp();
            return false;
        }
        
        return true;
    });
}

// ë¡œì¼“ ê²Œì„ ì ìˆ˜ ì—…ë°ì´íŠ¸
function updateRocketScore() {
    document.getElementById('rocketScore').textContent = rocketGame.score;
}

// ë¡œì¼“ ê²Œì„ ì¼ì‹œì •ì§€ (í–¥ìƒëœ ë²„ì „)
function pauseRocketGame() {
    rocketGame.isRunning = false;
    clearInterval(rocketGame.gameLoop);
    document.getElementById('rocketStartBtn').style.display = 'inline-block';
    document.getElementById('rocketPauseBtn').style.display = 'none';
    
    // ë°°ê²½ìŒì•… ì¼ì‹œì •ì§€
    if (rocketGame.sounds.background) {
        rocketGame.sounds.background.pause();
    }
}

// ê²Œì„ ì˜¤ë²„ (í–¥ìƒëœ ë²„ì „)
function gameOver() {
    pauseRocketGame();
    
    // í° í­ë°œ íš¨ê³¼
    createExplosion(rocketGame.rocket.x + rocketGame.rocket.width/2, rocketGame.rocket.y + rocketGame.rocket.height/2, '#FF6B6B');
    
    const expGained = Math.floor(rocketGame.score / 10);
    gainOwlExp(expGained);
    
    // ë©‹ì§„ ê²Œì„ ì˜¤ë²„ ì•Œë¦¼
    setTimeout(() => {
        const message = `ğŸš€ ê²Œì„ ì˜¤ë²„! ğŸš€\n\n` +
                       `ìµœì¢… ì ìˆ˜: ${rocketGame.score.toLocaleString()}ì \n` +
                       `íšë“ ê²½í—˜ì¹˜: +${expGained}\n\n` +
                       `í›Œë¥­í•œ ì¡°ì¢… ì‹¤ë ¥ì´ì—ˆìŠµë‹ˆë‹¤!`;
        alert(message);
    }, 500);
}

// ë˜‘ë¶€ë¦¬ ì“°ë‹¤ë“¬ê¸°
function petOwl() {
    owlData.happiness = Math.min(100, owlData.happiness + 5);
    gainOwlExp(10);
    updateOwlDisplay();
    
    // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
    var owl = document.querySelector('.owl-character');
    owl.style.transform = 'scale(1.2)';
    setTimeout(function() {
        owl.style.transform = 'scale(1)';
    }, 200);
    
    showMessage('ë˜‘ë¶€ë¦¬ê°€ ì¢‹ì•„í•©ë‹ˆë‹¤! í–‰ë³µë„ +5, ê²½í—˜ì¹˜ +10');
}

// ë˜‘ë¶€ë¦¬ ë¨¹ì´ì£¼ê¸°
function feedOwl() {
    if (owlData.money >= 50) {
        owlData.money -= 50;
        owlData.happiness = Math.min(100, owlData.happiness + 15);
        gainOwlExp(30);
        updateOwlDisplay();
        showMessage('ë˜‘ë¶€ë¦¬ì—ê²Œ ë¨¹ì´ë¥¼ ì¤¬ìŠµë‹ˆë‹¤! í–‰ë³µë„ +15, ê²½í—˜ì¹˜ +30');
    } else {
        showMessage('ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤! (í•„ìš”: 50ì½”ì¸)');
    }
}

// ë˜‘ë¶€ë¦¬ì™€ ê³µë¶€í•˜ê¸°
function studyWithOwl() {
    if (owlData.money >= 100) {
        owlData.money -= 100;
        owlData.knowledge = Math.min(100, owlData.knowledge + 8);
        gainOwlExp(80);
        updateOwlDisplay();
        showMessage('ë˜‘ë¶€ë¦¬ì™€ í•¨ê»˜ ê³µë¶€í–ˆìŠµë‹ˆë‹¤! ê²½ì œ ì§€ì‹ +8, ê²½í—˜ì¹˜ +80');
    } else {
        showMessage('ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤! (í•„ìš”: 100ì½”ì¸)');
    }
}

// ë˜‘ë¶€ë¦¬ì™€ íˆ¬ìí•˜ê¸°
function investWithOwl() {
    if (owlData.money >= 200) {
        var success = Math.random() > 0.3; // 70% ì„±ê³µë¥ 
        owlData.money -= 200;
        
        if (success) {
            var profit = Math.floor(Math.random() * 300) + 100;
            owlData.money += profit;
            owlData.investment = Math.min(100, owlData.investment + 5);
            gainOwlExp(100);
            showMessage('íˆ¬ì ì„±ê³µ! +' + profit + 'ì½”ì¸, íˆ¬ì ì‹¤ë ¥ +5, ê²½í—˜ì¹˜ +100');
        } else {
            owlData.investment = Math.min(100, owlData.investment + 2);
            gainOwlExp(50);
            showMessage('íˆ¬ì ì‹¤íŒ¨... í•˜ì§€ë§Œ ê²½í—˜ì€ ìŒ“ì˜€ìŠµë‹ˆë‹¤! íˆ¬ì ì‹¤ë ¥ +2, ê²½í—˜ì¹˜ +50');
        }
        updateOwlDisplay();
    } else {
        showMessage('ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤! (í•„ìš”: 200ì½”ì¸)');
    }
}

// ë˜‘ë¶€ë¦¬ ê²½í—˜ì¹˜ íšë“
function gainOwlExp(amount) {
    owlData.exp += amount;
    
    // ë ˆë²¨ì—… ì²´í¬
    if (owlData.exp >= owlData.maxExp) {
        owlData.level++;
        owlData.exp = 0;
        owlData.maxExp = owlData.level * 1000;
        owlData.money += owlData.level * 100;
        
        var levelNames = ['ì´ˆë³´ íˆ¬ìì', 'ê²¬ìŠµ íˆ¬ìì', 'ìˆ™ë ¨ íˆ¬ìì', 'ì „ë¬¸ íˆ¬ìì', 'íˆ¬ì ë§ˆìŠ¤í„°'];
        var levelName = levelNames[Math.min(owlData.level - 1, levelNames.length - 1)];
        
        showMessage('ë ˆë²¨ì—…! ë ˆë²¨ ' + owlData.level + ' - ' + levelName + '\në³´ë„ˆìŠ¤ ì½”ì¸ +' + (owlData.level * 100));
    }
    
    // ì „ì—­ ì‚¬ìš©ì ë ˆë²¨ ì‹œìŠ¤í…œì—ë„ ê²½í—˜ì¹˜ ì¶”ê°€
    if (window.levelManager && window.levelManager.currentUser) {
        const result = window.levelManager.addExperience(amount);
        if (result && result.levelUp) {
            // ì „ì—­ ë ˆë²¨ì—… ë°œìƒì‹œ ì¶•í•˜ ë©”ì‹œì§€
            window.levelManager.showLevelUpAnimation(result.newLevel);
        }
    }
    
    updateOwlDisplay();
    saveOwlData();
}

// ë˜‘ë¶€ë¦¬ ì •ë³´ ì—…ë°ì´íŠ¸
function updateOwlDisplay() {
    document.getElementById('owlLevel').textContent = 'ë ˆë²¨ ' + owlData.level + ' - ' + getLevelName();
    document.getElementById('owlExp').textContent = 'ê²½í—˜ì¹˜: ' + owlData.exp + ' / ' + owlData.maxExp;
    document.getElementById('owlExpBar').style.width = (owlData.exp / owlData.maxExp * 100) + '%';
    
    document.getElementById('owlKnowledge').textContent = owlData.knowledge;
    document.getElementById('owlInvestment').textContent = owlData.investment;
    document.getElementById('owlHappiness').textContent = owlData.happiness;
    document.getElementById('owlMoney').textContent = owlData.money.toLocaleString();
}

// ë ˆë²¨ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
function getLevelName() {
    var levelNames = ['ì´ˆë³´ íˆ¬ìì', 'ê²¬ìŠµ íˆ¬ìì', 'ìˆ™ë ¨ íˆ¬ìì', 'ì „ë¬¸ íˆ¬ìì', 'íˆ¬ì ë§ˆìŠ¤í„°'];
    return levelNames[Math.min(owlData.level - 1, levelNames.length - 1)];
}

// ë©”ì‹œì§€ í‘œì‹œ
function showMessage(message) {
    alert(message);
}

// ë˜‘ë¶€ë¦¬ ë°ì´í„° ì €ì¥
function saveOwlData() {
    localStorage.setItem('owlData', JSON.stringify(owlData));
}

// ê²Œì„ ìƒˆë¡œê³ ì¹¨
function refreshGames() {
    location.reload();
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
    // ë ˆë²¨ ë§¤ë‹ˆì €ë¥¼ í†µí•œ ì‚¬ìš©ì ì •ë³´ ë¡œë“œ
    if (window.levelManager) {
        currentUser = window.levelManager.currentUser;
        // ë ˆë²¨ í‘œì‹œ ì—…ë°ì´íŠ¸
        setTimeout(() => {
            window.levelManager.updateLevelDisplay();
        }, 100);
    }
    
    updateOwlDisplay();
    
    // ë ˆê±°ì‹œ ë ˆë²¨ í‘œì‹œ (ë°±ì—…ìš©)
    var levelBadge = document.getElementById('navLevelBadge');
    if (levelBadge && currentUser && currentUser.level) {
        var levelInfo = {
            yellow: 'YELLOW',
            orange: 'ORANGE', 
            green: 'GREEN',
            blue: 'BLUE',
            brown: 'BROWN',
            black: 'BLACK',
            red: 'RED'
        };
        levelBadge.textContent = levelInfo[currentUser.level] || 'YELLOW';
        levelBadge.className = 'level-badge-nav level-' + currentUser.level;
    }
});
</script>

</body>
</html>



